package ru.r2cloud.jradio.mobitex;

import java.io.DataInputStream;
import java.io.EOFException;
import java.io.IOException;

import org.junit.Test;

import ru.r2cloud.jradio.AssertJson;
import ru.r2cloud.jradio.fec.ViterbiTest;
import ru.r2cloud.jradio.fec.ccsds.UncorrectableException;

public class MobitexBeaconTest {

	@Test
	public void testEofException() throws Exception {
		byte[] data = ViterbiTest.hexStringToByteArray(
				"48097FF1B3DF1730017EF1E7ED9843D7D1D774E221B05E5515DFDD98B5D5DDBDFCC2030059C860BFA2C659F81F8A586F9B8862740FCC177E7687A39F3E4680EDCE2DE5FD07BE6F61558D1EDF971022F17FBF85902B25B96D0C287C2F625FD915BE30A37020D56E7B40BD73883324655FB277EAA515B807B56EF0A0D448470B9B242F83AE0D3C5DA87428138A026B034E5722415785612C174ED3371852C9E30A0A0849946229DEACDA03459EA2FDB0B634CBE51B1907D780A758EF29D48E12BFE86797E90E79FDE0DA000C6B3C50B6BCAEDEB72E0BC3670C34ECE5402D3D9A96F83A9ECCC70EFDEFEB3A8AD46A366A1FF94EE7BFAD6D447CD16C16AEDE03D0AD2F109007FC0E8FBF6B14E183C756FD92A7FC2E597CE2B3F98D5948282D7F34CB37700861A2BF055CCA7FCC62768C27828CCD8B8871F3B2055FF25DCE1260DC53EA8F0D939A51C4E733FC1914FA0DFE0E52192BE18733B84B1C1DED61AD80E89B8D11DB984149A5A3E6D053F5F42379312C797C99F6490743D7583AC22E7DE909BCC8B41C1DF2524F140F330766381ED730DDDC0E8E34B9E7B204D13D1ECA0913BB4DB88A0D2F8667D1870675170D0B62937C0846E1DF0E8F0022A2DCBF407DC0B5FC89491332473E3E691B9C9833C1ECB90E1099AA7018C7D6A5CA430C07FACBD5CE1498891FB1817F6713B2719324673E11F0103A7FE5CB484B828CAF882205366FFF355321BA146FE04CDF0D19794A4D438C48D51BB8FB6030E918CF39E4280DDC1C8B41765FD12981B79C1707E4F780AC7E071C90DE8166A11F6C273E729B4332FB2D4FC4D4CC22138B3D0F46A034AEFB103103DB70F4630703D66096D7E01CC78DDF17BE189DA70343E3F69315107E3D2C9D0D981E7BAEF3231CE703DECC0706E2F172125FC60F4D8392C8DB49CE35CFC6239F007660D8E2E78932926CACDB2477639F8C5F3E027A22D73051A4E961D9747C18F30E8390AC5E40B069F65E863FCE2318744F4CF6CC91304885CFCD6C654FA8CA93B47F0281D8D8B9761B890D15B391DF3F30A641673760F038CE5B1E0399E33E0FB79F00865E34F706C7C7E072DEF41D80B781CECD9536013D9E1C5537EB2A96DE31A22749FECC11E2FC1733E983CDEB60423B199ECC7B13A5EE30CCF5039C5F671222FD8995E930813E8A0D50F4F1CA049BF8F64CF2664821DD139994C1F79B658275C54DCE061F57C43D39F68E2597443886D0BFCA81DFC813A6039F7AFA4716616A243AC6E5630E0876C25BD4BD192705C43DA3C03CE32860EEC7E289E8BBFE1748073E395E3E81341C36C217ADCF5261F838FB0341FECF04E0237818059374DF05AF30B36796B4925E09DB38");
		TestMobitexBeacon beacon = new TestMobitexBeacon();
		beacon.readBeacon(data);
		AssertJson.assertObjectsEqual("MobitexBeaconEof.json", beacon);
	}

	private static class TestMobitexBeacon extends MobitexBeacon {

		@Override
		public void readBeacon(DataInputStream dis) throws IOException, UncorrectableException {
			throw new EOFException();
		}

	}
}
